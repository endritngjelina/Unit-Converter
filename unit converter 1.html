<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ConvertPro - Professional Unit Converter</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo {
            font-size: 2.5rem;
            font-weight: 700;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 10px;
        }

        .tagline {
            color: rgba(255,255,255,0.9);
            font-size: 1.1rem;
            font-weight: 300;
        }

        .main-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            flex: 1;
        }

        .converter-panel {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .category-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 30px;
        }

        .tab {
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            background: #f8f9fa;
            color: #6c757d;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .tab:hover:not(.active) {
            background: #e9ecef;
            transform: translateY(-1px);
        }

        .conversion-area {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 20px;
            align-items: end;
            margin-bottom: 30px;
        }

        .input-group {
            position: relative;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
            font-size: 0.9rem;
        }

        .input-field {
            width: 100%;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .input-field:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        select.input-field {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 12px center;
            background-repeat: no-repeat;
            background-size: 16px;
            padding-right: 40px;
        }

        .swap-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            color: white;
            font-size: 1.2rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .swap-btn:hover {
            transform: rotate(180deg) scale(1.1);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .result-display {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
        }

        .result-value {
            font-size: 2rem;
            font-weight: 700;
            color: #495057;
            margin-bottom: 5px;
        }

        .result-unit {
            font-size: 1.1rem;
            color: #6c757d;
            font-weight: 500;
        }

        .quick-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 10px 16px;
            border: 1px solid #dee2e6;
            border-radius: 20px;
            background: white;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            color: #495057;
        }

        .action-btn:hover {
            background: #f8f9fa;
            border-color: #667eea;
            transform: translateY(-1px);
        }

        .history-panel {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            max-height: 600px;
            overflow-y: auto;
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .history-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #495057;
        }

        .clear-history {
            background: none;
            border: 1px solid #dc3545;
            color: #dc3545;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .clear-history:hover {
            background: #dc3545;
            color: white;
        }

        .history-item {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 1px solid transparent;
        }

        .history-item:hover {
            background: white;
            border-color: #667eea;
            transform: translateX(5px);
        }

        .history-conversion {
            font-weight: 600;
            color: #495057;
            margin-bottom: 5px;
        }

        .history-meta {
            font-size: 0.8rem;
            color: #6c757d;
            display: flex;
            justify-content: space-between;
        }

        .keyboard-shortcuts {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 15px;
            border-radius: 12px;
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .keyboard-shortcuts.show {
            opacity: 1;
        }

        .shortcut-key {
            background: rgba(255,255,255,0.2);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
        }

        .favorites-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #dee2e6;
        }

        .favorites-title {
            font-size: 1rem;
            font-weight: 600;
            color: #495057;
            margin-bottom: 10px;
        }

        .favorite-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #fff3cd;
            border-radius: 8px;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .favorite-remove {
            background: none;
            border: none;
            color: #856404;
            cursor: pointer;
            font-size: 0.8rem;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.3s ease;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .conversion-area {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .swap-btn {
                justify-self: center;
                transform: rotate(90deg);
            }
        }

        .loading-spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">ConvertPro</div>
            <div class="tagline">Professional Unit Conversion Suite</div>
        </header>

        <div class="main-content">
            <div class="converter-panel">
                <div class="category-tabs">
                    <button class="tab active" data-category="length">Length</button>
                    <button class="tab" data-category="weight">Weight</button>
                    <button class="tab" data-category="temperature">Temperature</button>
                    <button class="tab" data-category="area">Area</button>
                    <button class="tab" data-category="volume">Volume</button>
                    <button class="tab" data-category="speed">Speed</button>
                    <button class="tab" data-category="energy">Energy</button>
                    <button class="tab" data-category="power">Power</button>
                </div>

                <div class="conversion-area">
                    <div class="input-group">
                        <label for="from-value">From</label>
                        <input type="number" id="from-value" class="input-field" placeholder="Enter value" step="any">
                        <select id="from-unit" class="input-field"></select>
                    </div>

                    <button class="swap-btn" id="swap-btn">‚áÑ</button>

                    <div class="input-group">
                        <label for="to-value">To</label>
                        <input type="number" id="to-value" class="input-field" placeholder="Result" readonly>
                        <select id="to-unit" class="input-field"></select>
                    </div>
                </div>

                <div class="result-display">
                    <div class="loading-spinner" id="loading"></div>
                    <div class="result-value" id="result-value">0</div>
                    <div class="result-unit" id="result-unit">Select units to convert</div>
                </div>

                <div class="quick-actions">
                    <button class="action-btn" onclick="copyResult()">üìã Copy Result</button>
                    <button class="action-btn" onclick="addToFavorites()">‚≠ê Add to Favorites</button>
                    <button class="action-btn" onclick="clearAll()">üóëÔ∏è Clear All</button>
                    <button class="action-btn" onclick="toggleShortcuts()">‚å®Ô∏è Shortcuts</button>
                </div>

                <div class="favorites-section" id="favorites-section" style="display: none;">
                    <div class="favorites-title">Favorite Conversions</div>
                    <div id="favorites-list"></div>
                </div>
            </div>

            <div class="history-panel">
                <div class="history-header">
                    <div class="history-title">Conversion History</div>
                    <button class="clear-history" onclick="clearHistory()">Clear All</button>
                </div>
                <div id="history-list">
                    <div style="text-align: center; color: #6c757d; padding: 20px;">
                        No conversions yet. Start converting to see your history!
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="keyboard-shortcuts" id="shortcuts">
        <div><span class="shortcut-key">Tab</span> - Switch between fields</div>
        <div><span class="shortcut-key">Ctrl+S</span> - Swap units</div>
        <div><span class="shortcut-key">Ctrl+C</span> - Copy result</div>
        <div><span class="shortcut-key">Ctrl+K</span> - Clear all</div>
        <div><span class="shortcut-key">Esc</span> - Hide shortcuts</div>
    </div>

    <script>
        // Unit definitions with precise conversion factors
        const units = {
            length: {
                meter: { name: 'Meter', factor: 1, symbol: 'm' },
                kilometer: { name: 'Kilometer', factor: 0.001, symbol: 'km' },
                centimeter: { name: 'Centimeter', factor: 100, symbol: 'cm' },
                millimeter: { name: 'Millimeter', factor: 1000, symbol: 'mm' },
                inch: { name: 'Inch', factor: 39.3701, symbol: 'in' },
                foot: { name: 'Foot', factor: 3.28084, symbol: 'ft' },
                yard: { name: 'Yard', factor: 1.09361, symbol: 'yd' },
                mile: { name: 'Mile', factor: 0.000621371, symbol: 'mi' },
                nauticalMile: { name: 'Nautical Mile', factor: 0.000539957, symbol: 'nmi' }
            },
            weight: {
                kilogram: { name: 'Kilogram', factor: 1, symbol: 'kg' },
                gram: { name: 'Gram', factor: 1000, symbol: 'g' },
                pound: { name: 'Pound', factor: 2.20462, symbol: 'lb' },
                ounce: { name: 'Ounce', factor: 35.274, symbol: 'oz' },
                stone: { name: 'Stone', factor: 0.157473, symbol: 'st' },
                ton: { name: 'Ton', factor: 0.001, symbol: 't' },
                shortTon: { name: 'Short Ton (US)', factor: 0.00110231, symbol: 'ton' }
            },
            temperature: {
                celsius: { name: 'Celsius', symbol: '¬∞C' },
                fahrenheit: { name: 'Fahrenheit', symbol: '¬∞F' },
                kelvin: { name: 'Kelvin', symbol: 'K' },
                rankine: { name: 'Rankine', symbol: '¬∞R' }
            },
            area: {
                squareMeter: { name: 'Square Meter', factor: 1, symbol: 'm¬≤' },
                squareKilometer: { name: 'Square Kilometer', factor: 0.000001, symbol: 'km¬≤' },
                squareCentimeter: { name: 'Square Centimeter', factor: 10000, symbol: 'cm¬≤' },
                squareInch: { name: 'Square Inch', factor: 1550.0031, symbol: 'in¬≤' },
                squareFoot: { name: 'Square Foot', factor: 10.7639, symbol: 'ft¬≤' },
                squareYard: { name: 'Square Yard', factor: 1.19599, symbol: 'yd¬≤' },
                acre: { name: 'Acre', factor: 0.000247105, symbol: 'ac' },
                hectare: { name: 'Hectare', factor: 0.0001, symbol: 'ha' }
            },
            volume: {
                liter: { name: 'Liter', factor: 1, symbol: 'L' },
                milliliter: { name: 'Milliliter', factor: 1000, symbol: 'mL' },
                cubicMeter: { name: 'Cubic Meter', factor: 0.001, symbol: 'm¬≥' },
                gallon: { name: 'Gallon (US)', factor: 0.264172, symbol: 'gal' },
                quart: { name: 'Quart (US)', factor: 1.05669, symbol: 'qt' },
                pint: { name: 'Pint (US)', factor: 2.11338, symbol: 'pt' },
                cup: { name: 'Cup (US)', factor: 4.22675, symbol: 'cup' },
                fluidOunce: { name: 'Fluid Ounce (US)', factor: 33.814, symbol: 'fl oz' }
            },
            speed: {
                meterPerSecond: { name: 'Meter/Second', factor: 1, symbol: 'm/s' },
                kilometerPerHour: { name: 'Kilometer/Hour', factor: 3.6, symbol: 'km/h' },
                milePerHour: { name: 'Mile/Hour', factor: 2.23694, symbol: 'mph' },
                knot: { name: 'Knot', factor: 1.94384, symbol: 'kn' },
                footPerSecond: { name: 'Foot/Second', factor: 3.28084, symbol: 'ft/s' }
            },
            energy: {
                joule: { name: 'Joule', factor: 1, symbol: 'J' },
                kilojoule: { name: 'Kilojoule', factor: 0.001, symbol: 'kJ' },
                calorie: { name: 'Calorie', factor: 0.239006, symbol: 'cal' },
                kilocalorie: { name: 'Kilocalorie', factor: 0.000239006, symbol: 'kcal' },
                wattHour: { name: 'Watt-hour', factor: 0.000277778, symbol: 'Wh' },
                kilowattHour: { name: 'Kilowatt-hour', factor: 0.000000277778, symbol: 'kWh' },
                btu: { name: 'British Thermal Unit', factor: 0.000947817, symbol: 'BTU' }
            },
            power: {
                watt: { name: 'Watt', factor: 1, symbol: 'W' },
                kilowatt: { name: 'Kilowatt', factor: 0.001, symbol: 'kW' },
                horsepower: { name: 'Horsepower', factor: 0.00134102, symbol: 'hp' },
                metricHorsepower: { name: 'Metric Horsepower', factor: 0.00135962, symbol: 'PS' },
                btuPerHour: { name: 'BTU/Hour', factor: 3.41214, symbol: 'BTU/h' }
            }
        };

        let currentCategory = 'length';
        let conversionHistory = [];
        let favoriteConversions = [];

        // Initialize the converter
        function init() {
            setupEventListeners();
            populateUnits();
            loadHistory();
            loadFavorites();
        }

        function setupEventListeners() {
            // Tab switching
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => switchCategory(tab.dataset.category));
            });

            // Input events
            document.getElementById('from-value').addEventListener('input', debounce(convert, 300));
            document.getElementById('from-unit').addEventListener('change', convert);
            document.getElementById('to-unit').addEventListener('change', convert);

            // Swap button
            document.getElementById('swap-btn').addEventListener('click', swapUnits);

            // Keyboard shortcuts
            document.addEventListener('keydown', handleKeyboardShortcuts);

            // History item clicks
            document.getElementById('history-list').addEventListener('click', (e) => {
                if (e.target.classList.contains('history-item') || e.target.closest('.history-item')) {
                    const item = e.target.closest('.history-item');
                    if (item && item.dataset.conversion) {
                        loadHistoryItem(JSON.parse(item.dataset.conversion));
                    }
                }
            });
        }

        function switchCategory(category) {
            currentCategory = category;
            
            // Update active tab
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector(`[data-category="${category}"]`).classList.add('active');
            
            // Reset values
            document.getElementById('from-value').value = '';
            document.getElementById('to-value').value = '';
            
            populateUnits();
            updateResult(0, units[category][Object.keys(units[category])[0]].symbol);
        }

        function populateUnits() {
            const fromSelect = document.getElementById('from-unit');
            const toSelect = document.getElementById('to-unit');
            
            // Clear existing options
            fromSelect.innerHTML = '';
            toSelect.innerHTML = '';
            
            // Populate with current category units
            Object.entries(units[currentCategory]).forEach(([key, unit]) => {
                const option1 = new Option(unit.name, key);
                const option2 = new Option(unit.name, key);
                fromSelect.add(option1);
                toSelect.add(option2);
            });
            
            // Set default selections
            if (toSelect.options.length > 1) {
                toSelect.selectedIndex = 1;
            }
        }

        function convert() {
            const fromValue = parseFloat(document.getElementById('from-value').value);
            const fromUnit = document.getElementById('from-unit').value;
            const toUnit = document.getElementById('to-unit').value;
            
            if (isNaN(fromValue) || fromValue === '') {
                updateResult(0, units[currentCategory][toUnit].symbol);
                return;
            }

            showLoading(true);
            
            setTimeout(() => {
                let result;
                
                if (currentCategory === 'temperature') {
                    result = convertTemperature(fromValue, fromUnit, toUnit);
                } else {
                    const fromFactor = units[currentCategory][fromUnit].factor;
                    const toFactor = units[currentCategory][toUnit].factor;
                    result = (fromValue / fromFactor) * toFactor;
                }
                
                document.getElementById('to-value').value = result.toFixed(6).replace(/\.?0+$/, '');
                updateResult(result, units[currentCategory][toUnit].symbol);
                
                // Add to history
                addToHistory({
                    category: currentCategory,
                    fromValue,
                    fromUnit,
                    toValue: result,
                    toUnit,
                    timestamp: new Date()
                });
                
                showLoading(false);
            }, 100);
        }

        function convertTemperature(value, from, to) {
            // Convert to Celsius first
            let celsius;
            switch (from) {
                case 'celsius': celsius = value; break;
                case 'fahrenheit': celsius = (value - 32) * 5/9; break;
                case 'kelvin': celsius = value - 273.15; break;
                case 'rankine': celsius = (value - 491.67) * 5/9; break;
            }
            
            // Convert from Celsius to target
            switch (to) {
                case 'celsius': return celsius;
                case 'fahrenheit': return celsius * 9/5 + 32;
                case 'kelvin': return celsius + 273.15;
                case 'rankine': return celsius * 9/5 + 491.67;
            }
        }

        function swapUnits() {
            const fromUnit = document.getElementById('from-unit');
            const toUnit = document.getElementById('to-unit');
            const fromValue = document.getElementById('from-value');
            const toValue = document.getElementById('to-value');
            
            // Swap unit selections
            const tempUnit = fromUnit.value;
            fromUnit.value = toUnit.value;
            toUnit.value = tempUnit;
            
            // Swap values
            const tempValue = fromValue.value;
            fromValue.value = toValue.value;
            toValue.value = tempValue;
            
            convert();
        }

        function updateResult(value, unit) {
            document.getElementById('result-value').textContent = 
                value.toLocaleString('en-US', { maximumFractionDigits: 6 });
            document.getElementById('result-unit').textContent = unit;
        }

        function showLoading(show) {
            const spinner = document.getElementById('loading');
            const resultValue = document.getElementById('result-value');
            const resultUnit = document.getElementById('result-unit');
            
            if (show) {
                spinner.style.display = 'block';
                resultValue.style.opacity = '0.3';
                resultUnit.style.opacity = '0.3';
            } else {
                spinner.style.display = 'none';
                resultValue.style.opacity = '1';
                resultUnit.style.opacity = '1';
            }
        }

        function addToHistory(conversion) {
            conversionHistory.unshift(conversion);
            if (conversionHistory.length > 50) {
                conversionHistory = conversionHistory.slice(0, 50);
            }
            saveHistory();
            updateHistoryDisplay();
        }

        function updateHistoryDisplay() {
            const historyList = document.getElementById('history-list');
            
            if (conversionHistory.length === 0) {
                historyList.innerHTML = `
                    <div style="text-align: center; color: #6c757d; padding: 20px;">
                        No conversions yet. Start converting to see your history!
                    </div>
                `;
                return;
            }
            
            historyList.innerHTML = conversionHistory.map(item => {
                const fromUnitName = units[item.category][item.fromUnit].name;
                const toUnitName = units[item.category][item.toUnit].name;
                const fromSymbol = units[item.category][item.fromUnit].symbol;
                const toSymbol = units[item.category][item.toUnit].symbol;
                
                return `
                    <div class="history-item fade-in" data-conversion='${JSON.stringify(item)}'>
                        <div class="history-conversion">
                            ${item.fromValue.toLocaleString()} ${fromSymbol} = 
                            ${item.toValue.toLocaleString('en-US', { maximumFractionDigits: 6 })} ${toSymbol}
                        </div>
                        <div class="history-meta">
                            <span>${fromUnitName} ‚Üí ${toUnitName}</span>
                            <span>${new Date(item.timestamp).toLocaleTimeString()}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function loadHistoryItem(conversion) {
            switchCategory(conversion.category);
            setTimeout(() => {
                document.getElementById('from-value').value = conversion.fromValue;
                document.getElementById('from-unit').value = conversion.fromUnit;
                document.getElementById('to-unit').value = conversion.toUnit;
                convert();
            }, 100);
        }

        function clearHistory() {
            if (confirm('Are you sure you want to clear all history?')) {
                conversionHistory = [];
                saveHistory();
                updateHistoryDisplay();
            }
        }

        function saveHistory() {
            // In a real application, this would save to a database or localStorage
            // For demo purposes, we'll keep it in memory
        }

        function loadHistory() {
            // In a real application, this would load from a database or localStorage
            updateHistoryDisplay();
        }

        function addToFavorites() {
            const fromValue = document.getElementById('from-value').value;
            const fromUnit = document.getElementById('from-unit').value;
            const toUnit = document.getElementById('to-unit').value;
            
            if (!fromValue || !fromUnit || !toUnit) {
                alert('Please complete a conversion first');
                return;
            }
            
            const favorite = {
                category: currentCategory,
                fromUnit,
                toUnit,
                name: `${units[currentCategory][fromUnit].name} to ${units[currentCategory][toUnit].name}`
            };
            
            // Check if already exists
            const exists = favoriteConversions.some(fav => 
                fav.category === favorite.category && 
                fav.fromUnit === favorite.fromUnit && 
                fav.toUnit === favorite.toUnit
            );
            
            if (exists) {
                alert('This conversion is already in your favorites');
                return;
            }
            
            favoriteConversions.push(favorite);
            saveFavorites();
            updateFavoritesDisplay();
            alert('Added to favorites!');
        }

        function updateFavoritesDisplay() {
            const favoritesSection = document.getElementById('favorites-section');
            const favoritesList = document.getElementById('favorites-list');
            
            if (favoriteConversions.length === 0) {
                favoritesSection.style.display = 'none';
                return;
            }
            
            favoritesSection.style.display = 'block';
            favoritesList.innerHTML = favoriteConversions.map((fav, index) => `
                <div class="favorite-item">
                    <span onclick="loadFavorite(${index})" style="cursor: pointer; flex: 1;">
                        ${fav.name} (${fav.category})
                    </span>
                    <button class="favorite-remove" onclick="removeFavorite(${index})">‚úï</button>
                </div>
            `).join('');
        }

        function loadFavorite(index) {
            const favorite = favoriteConversions[index];
            switchCategory(favorite.category);
            setTimeout(() => {
                document.getElementById('from-unit').value = favorite.fromUnit;
                document.getElementById('to-unit').value = favorite.toUnit;
                document.getElementById('from-value').focus();
            }, 100);
        }

        function removeFavorite(index) {
            favoriteConversions.splice(index, 1);
            saveFavorites();
            updateFavoritesDisplay();
        }

        function saveFavorites() {
            // In a real application, this would save to localStorage or database
        }

        function loadFavorites() {
            updateFavoritesDisplay();
        }

        function copyResult() {
            const resultValue = document.getElementById('result-value').textContent;
            const resultUnit = document.getElementById('result-unit').textContent;
            const textToCopy = `${resultValue} ${resultUnit}`;
            
            navigator.clipboard.writeText(textToCopy).then(() => {
                // Show temporary success message
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = '‚úì Copied!';
                btn.style.background = '#28a745';
                btn.style.color = 'white';
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '';
                    btn.style.color = '';
                }, 2000);
            }).catch(() => {
                alert('Failed to copy to clipboard');
            });
        }

        function clearAll() {
            document.getElementById('from-value').value = '';
            document.getElementById('to-value').value = '';
            updateResult(0, units[currentCategory][document.getElementById('to-unit').value].symbol);
        }

        function toggleShortcuts() {
            const shortcuts = document.getElementById('shortcuts');
            shortcuts.classList.toggle('show');
            setTimeout(() => {
                if (shortcuts.classList.contains('show')) {
                    shortcuts.classList.remove('show');
                }
            }, 5000);
        }

        function handleKeyboardShortcuts(e) {
            if (e.ctrlKey || e.metaKey) {
                switch (e.key) {
                    case 's':
                        e.preventDefault();
                        swapUnits();
                        break;
                    case 'c':
                        e.preventDefault();
                        copyResult();
                        break;
                    case 'k':
                        e.preventDefault();
                        clearAll();
                        break;
                }
            }
            
            if (e.key === 'Escape') {
                document.getElementById('shortcuts').classList.remove('show');
            }
            
            // Quick category switching
            if (e.altKey && !isNaN(e.key) && e.key >= 1 && e.key <= 8) {
                e.preventDefault();
                const categories = ['length', 'weight', 'temperature', 'area', 'volume', 'speed', 'energy', 'power'];
                const categoryIndex = parseInt(e.key) - 1;
                if (categories[categoryIndex]) {
                    switchCategory(categories[categoryIndex]);
                }
            }
        }

        // Utility function for debouncing input
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Advanced features

        // Auto-complete for common conversions
        function setupAutoComplete() {
            const commonConversions = {
                length: [
                    { from: 'foot', to: 'meter', label: 'Feet to Meters' },
                    { from: 'inch', to: 'centimeter', label: 'Inches to Centimeters' },
                    { from: 'mile', to: 'kilometer', label: 'Miles to Kilometers' }
                ],
                weight: [
                    { from: 'pound', to: 'kilogram', label: 'Pounds to Kilograms' },
                    { from: 'ounce', to: 'gram', label: 'Ounces to Grams' }
                ],
                temperature: [
                    { from: 'fahrenheit', to: 'celsius', label: 'Fahrenheit to Celsius' },
                    { from: 'celsius', to: 'fahrenheit', label: 'Celsius to Fahrenheit' }
                ]
            };
            
            // This could be expanded to show suggestions as the user types
        }

        // Precision control
        function setPrecision(digits) {
            const result = document.getElementById('to-value');
            const value = parseFloat(result.value);
            if (!isNaN(value)) {
                result.value = value.toFixed(digits);
            }
        }

        // Export/Import functionality
        function exportHistory() {
            const data = {
                history: conversionHistory,
                favorites: favoriteConversions,
                timestamp: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'convertpro-data.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        function importHistory(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    if (data.history) conversionHistory = data.history;
                    if (data.favorites) favoriteConversions = data.favorites;
                    updateHistoryDisplay();
                    updateFavoritesDisplay();
                    alert('Data imported successfully!');
                } catch (error) {
                    alert('Error importing data: Invalid file format');
                }
            };
            reader.readAsText(file);
        }

        // Calculation expressions
        function evaluateExpression(expr) {
            try {
                // Simple expression evaluation (could be enhanced with a proper math parser)
                const sanitized = expr.replace(/[^0-9+\-*/().\s]/g, '');
                return Function('"use strict"; return (' + sanitized + ')')();
            } catch {
                return NaN;
            }
        }

        // Enhanced input handling for expressions
        document.getElementById('from-value').addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                const expr = this.value;
                const result = evaluateExpression(expr);
                if (!isNaN(result)) {
                    this.value = result;
                    convert();
                }
            }
        });

        // Theme toggle functionality
        function toggleTheme() {
            document.body.classList.toggle('dark-theme');
            // Save preference
            localStorage.setItem('convertpro-theme', 
                document.body.classList.contains('dark-theme') ? 'dark' : 'light');
        }

        // Unit search functionality
        function searchUnits(query) {
            const allUnits = [];
            Object.entries(units).forEach(([category, categoryUnits]) => {
                Object.entries(categoryUnits).forEach(([key, unit]) => {
                    allUnits.push({ category, key, ...unit });
                });
            });
            
            return allUnits.filter(unit => 
                unit.name.toLowerCase().includes(query.toLowerCase()) ||
                unit.symbol.toLowerCase().includes(query.toLowerCase())
            );
        }

        // Initialize everything when the page loads
        document.addEventListener('DOMContentLoaded', init);

        // Add some CSS for dark theme
        const darkThemeStyles = `
            .dark-theme {
                background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            }
            
            .dark-theme .converter-panel,
            .dark-theme .history-panel {
                background: rgba(52, 73, 94, 0.95);
                color: #ecf0f1;
            }
            
            .dark-theme .tab {
                background: #34495e;
                color: #bdc3c7;
            }
            
            .dark-theme .tab.active {
                background: linear-gradient(135deg, #3498db, #2980b9);
            }
            
            .dark-theme .input-field {
                background: #2c3e50;
                border-color: #34495e;
                color: #ecf0f1;
            }
            
            .dark-theme .result-display {
                background: linear-gradient(135deg, #34495e, #2c3e50);
                color: #ecf0f1;
            }
            
            .dark-theme .history-item {
                background: #2c3e50;
                color: #ecf0f1;
            }
            
            .dark-theme .favorite-item {
                background: #34495e;
                color: #ecf0f1;
            }
        `;
        
        // Add dark theme styles to document
        const styleSheet = document.createElement('style');
        styleSheet.textContent = darkThemeStyles;
        document.head.appendChild(styleSheet);

        // Performance monitoring
        let conversionCount = 0;
        let startTime = Date.now();

        function trackPerformance() {
            conversionCount++;
            if (conversionCount % 10 === 0) {
                const elapsed = Date.now() - startTime;
                console.log(`Performance: ${conversionCount} conversions in ${elapsed}ms`);
            }
        }

        // Add performance tracking to convert function
        const originalConvert = convert;
        convert = function() {
            trackPerformance();
            return originalConvert.apply(this, arguments);
        };

        // Add more quick action buttons
        setTimeout(() => {
            const quickActions = document.querySelector('.quick-actions');
            
            // Add precision control buttons
            const precisionGroup = document.createElement('div');
            precisionGroup.style.display = 'flex';
            precisionGroup.style.gap = '5px';
            precisionGroup.innerHTML = `
                <button class="action-btn" onclick="setPrecision(0)" title="No decimals">0</button>
                <button class="action-btn" onclick="setPrecision(2)" title="2 decimal places">0.00</button>
                <button class="action-btn" onclick="setPrecision(4)" title="4 decimal places">0.0000</button>
            `;
            
            // Add export/import buttons
            const dataButtons = document.createElement('div');
            dataButtons.style.display = 'flex';
            dataButtons.style.gap = '5px';
            dataButtons.innerHTML = `
                <button class="action-btn" onclick="exportHistory()" title="Export data">üì§ Export</button>
                <input type="file" id="import-file" accept=".json" style="display: none;" 
                       onchange="importHistory(this.files[0])">
                <button class="action-btn" onclick="document.getElementById('import-file').click()" 
                        title="Import data">üì• Import</button>
            `;
            
            quickActions.appendChild(precisionGroup);
            quickActions.appendChild(dataButtons);
        }, 1000);

    </script>
</body>
</html>